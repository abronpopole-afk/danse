private async captureScreen(windowHandle: number): Promise<Buffer> {
  logger.debug("GGClubAdapter", `[${windowHandle}] captureScreen - tentative`);
  
  if (screenshotDesktop) {
    try {
      const window = this.activeWindows.get(`ggclub_${windowHandle}`);
      if (!window) {
        logger.error("GGClubAdapter", `[${windowHandle}] Fenêtre non trouvée`);
        return Buffer.alloc(0);
      }

      logger.info("GGClubAdapter", `[${windowHandle}] Capture écran entier puis crop vers fenêtre: ${window.title} (${window.width}x${window.height}) position (${window.x},${window.y})`);
      
      // 1. Capturer l'écran ENTIER
      const fullScreenPng = await screenshotDesktop({ format: 'png' });
      
      if (!fullScreenPng || fullScreenPng.length === 0) {
        logger.error("GGClubAdapter", `[${windowHandle}] Capture écran retournée vide`);
        return Buffer.alloc(0);
      }

      logger.info("GGClubAdapter", `[${windowHandle}] PNG écran entier reçu (${fullScreenPng.length} bytes)`);
      
      // 2. Décoder PNG en RGBA
      const fullRgbaBuffer = await this.decodePngToRgba(fullScreenPng);
      
      // 3. Extraire JUSTE la région de la fenêtre
      const screenWidth = Math.round(Math.sqrt(fullRgbaBuffer.length / 4 * (16/9))); // Approximation
      const screenHeight = Math.round(fullRgbaBuffer.length / 4 / screenWidth);
      
      logger.info("GGClubAdapter", `[${windowHandle}] Écran complet décodé: ${screenWidth}x${screenHeight}, crop vers fenêtre (${window.width}x${window.height})`);
      
      const croppedBuffer = this.cropRgbaRegion(
        fullRgbaBuffer,
        screenWidth,
        screenHeight,
        window.x,
        window.y,
        window.width,
        window.height
      );
      
      logger.info("GGClubAdapter", `[${windowHandle}] ✅ Capture réussie: ${croppedBuffer.length} octets (fenêtre ${window.width}x${window.height})`);
      return croppedBuffer;
      
    } catch (error) {
      logger.error("GGClubAdapter", `[${windowHandle}] Erreur capture/crop`, { error: String(error) });
      return Buffer.alloc(0);
    }
  }

  logger.error("GGClubAdapter", `[${windowHandle}] screenshot-desktop indisponible`);
  return Buffer.alloc(0);
}